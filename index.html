function doGet(e) {
  try {
    const sheetId = "1H69j5tNfmoToaq8JSglddDwsqck-jUN1dXDN_llJmzw"; // ID de tu Google Sheet
    const sheetName = "Hoja 1"; // Verifica que el nombre sea correcto
    const sheet = SpreadsheetApp.openById(sheetId).getSheetByName(sheetName);
    
    if (!sheet) {
      throw new Error("No se encontr칩 la hoja en el archivo de Google Sheets.");
    }

    // Obtener par치metros de la URL
    const ctwaClid = e.parameter.ctwa_clid || "N/A";
    const userAgent = e.parameter.user_agent || "N/A";

    // Validar par치metros
    if (ctwaClid === "N/A" || userAgent === "N/A") {
      throw new Error("Faltan par치metros obligatorios.");
    }

    // Escribir en Google Sheets
    sheet.appendRow([new Date(), "+5491140432778", ctwaClid, userAgent, "No"]);

    return ContentService.createTextOutput("OK").setMimeType(ContentService.MimeType.TEXT);

  } catch (error) {
    return ContentService.createTextOutput("Error detectado: " + error.message)
      .setMimeType(ContentService.MimeType.TEXT);
  }
}
